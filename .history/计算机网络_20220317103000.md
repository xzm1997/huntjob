# 基本概念
## 层与数据
- **应用层**
  - 消息`message`
  - `DHCP`, `DNS`, `FTP`, `Gopher`, `HTTP`, `IMAP4`, `IRC`, `NNTP`, `XMPP`, `POP3`, `SIP`, `SMTP`, `SNMP`, `SSH`, `TELNET`, `RPC`, `RTCP`, `RTSP`, `TLS`, `SDP`, `SOAP`, `GTP`, `STUN`, `NTP`, 更多
- **传输层**
  - 数据段`segment`
  - `TCP`, `UDP`, `DCCP`, `SCTP`, `RTP`, `RSVP`, `PPTP`, 更多
- **网络层**
  - 分组、数据包`packet`, `datagram`
  - `IP (IPv4`, `IPv6)`, `ARP`, `RARP`, `ICMP`, `ICMPv6`, `IGMP`, `RIP`, `OSPF`, `BGP`, `IS-IS`, `IPsec`, 更多
  - 可用`ping`检验连通
- **链路层**
  - 帧`frame`
  - `802.11`, `802.16`, `Wi-Fi`, `WiMAX`, `ATM`, `DTM`, `令牌环`, `以太网`, `FDDI`, `帧中继`, `GPRS`, `EVDO`, `HSPA`, `HDLC`, `PPP`, `L2TP`, `ISDN`, 更多
- **物理层**
  - `P-PD` `Ubit`
  - `RS-443`, `RS-232C`, `RS-485`, `理-2593`
![计算机体系结构](https://uploadfiles.nowcoder.com/images/20200623/655130036_1592902110246_6247F5A3CCCC226448FC618CFC88868E)

## 层与设备
设备 | 作用于 | 层
| :---: | :---: | :---: |
网卡|作用于|物理层
中继器|作用于|物理层
集线器|作用于|物理层
网桥|作用于|数据链路层
交换机|作用于|数据链路层
路由器|作用于|网络层

## 网络协议
- `SNMP` **简单网络管理协议**。该协议能支持网络管理系统，用于监测连接到网络上的设备是否有任何引起管理者关注的情况。
- `FTP` (File Transfer Protocol) **文件传输协议**，用于Internet上的控制文件的双向传输。
- `ICMP` (Internet Control Message Protocol) **Internet控制报文协议**。用于IP主机、路由器之间传递控制消息
- `SMTP` (Simple Mail Transfer Protocal) 是**简单邮件传输协议**，是一组用于由源地址到目的地址传送邮件的规则，帮助每台计算机在发送或中转信件时找到下一个目的地。是**TCP协议**支持的应用协议。
- 接受邮件使用`POP3`


## 拓扑结构
- **总线型**`IEEE 802.3`
  - 网络上所有的计算机都通过一条电缆相互连接起来。
  - **信号反射**和**终结器**：在总线型网络中，信号会沿着网线发送到整个网络。当信号到达线缆的端点时，将产生反射信号，这种发射信号会与后续信号发送冲突，从而使通信中断。为了防止通信中断，必须在线缆的两端安装**终结器**，以吸收端点信号，防止信号反弹。
- **星形拓朴结构**
  - 每个节点都由一个单独的通信线路连接到中心节点上。
  - 中心节点控制全网的通信，任何两台计算机之间的通信都要通过中心节点来转接。因些中心节点是网络的瓶颈，这种拓朴结构又称为集中控制式网络结构，这种拓扑结构是目前使用最普遍的拓扑结构，处于中心的网络设备跨越式集线器（Hub）也可以是交换机。
- **环形拓扑结构**
  - 环型拓扑结构是以一个共享的环型信道连接所有设备，称为**令牌环**。在环型拓扑中，信号会沿着环型信道按一个方向传播，并通过每台计算机。而且，每台计算机会对信号进行放大后，传给下一台计算机。同时，在网络中有一种特殊的信号称为令牌。令牌按顺时针方向传输。当某台计算机要发送信息时，必须先捕获令牌，再发送信息。发送信息后在释放令牌。
  - 环型结构的显著特点是每个节点用户都与两个相邻节点用户相连。
  - 工作站以**串行**方式顺序相连，形成一个**封闭**的环路结构。数据顺序通过每一工作站，直至到达数据的原发者才停止。
  - **不会有**多点冲突，每时每刻只有得到令牌的节点才能发送数据
- **树形拓扑结构**
  - 树型结构是星型结构的扩展，它由**根**结点和**分支**结点所构成
  - 对根结点的依赖性大，一旦根结点出现故障，将导致全网不能工作

# 硬件
## 传输介质
- 双绞线的最大传输距离为100m。如果要加大传输距离，在两段双绞线之间可安装中继器，最多可安装4个中继器。
- 同轴电缆的最大传输距离小于1000米
- 系带系统使用数字信号传输

## 组成
- 从**计算机网络系统**看，计算机网络是由计算机网络的**硬件系统**和**网络软件系统**组成的；
- 从**拓补结构**看，计算机网络是由**网络节点**和**通信链路**组成的；
- 从**逻辑功能**看，计算机网络是由**用户资源子网**和**通信子网**组成的。

## IEEE 802
- `IEEE 802`又称为LMSC（LAN/MAN Standards Committee，局域网/城域网标准委员会），致力于研究局域网和城域网的物理层和`MAC`层中定义的服务和协议，对应`OSI`网络参考模型的最低两层（即物理层和数据链路层）。

标准 | 说明
| :---: | :---: |
IEEE 802.1 | 局域网体系结构、寻址、网络互联和网络。
IEEE 802.1A | 概述和系统结构。
IEEE 802.1B | 网络管理和网络互连。
IEEE 802.2 | 逻辑链路控制子层（LLC）的定义。
IEEE 802.3 | 以太网介质访问控制协议 （CSMA/CD）及物理层技术规范。
IEEE 802.4 | 令牌总线网（Token-Bus）的介质访问控制协议及物理层技术规范。
IEEE 802.5 | 令牌环网（Token-Ring)的介质访问控制协议及物理层技术规范。
IEEE 802.6 | 城域网介质访问控制协议DQDB （Distributed Queue Dual Bus 分布式队列双总线）及物理层技术规范。
IEEE 802.7 | 宽带技术咨询组，提供有关宽带联网的技术咨询。
IEEE 802.8 | 光纤技术咨询组，提供有关光纤联网的技术咨询。
IEEE 802.9 | 综合声音数据的局域网（IVD LAN）介质访问控制协议及物理层技术规范。
IEEE 802.10 | 网络安全技术咨询组，定义了网络互操作的认证和加密方法。
IEEE 802.11 | 无线局域网（WLAN）的介质访问控制协议及物理层技术规范。

# 计算
## 子网计算
- **TODO:** 待补充


# IP协议
## IP路由器功能
- 运行路由协议，设置路由表
- 监测到拥塞时，合理丢弃 IP 分组
- 根据收到的 IP 分组的目的 IP 地址，将其转发到合适的输出线路上

## TTL(生存时间(Time To Live))
- TTL(生存时间(Time To Live))是IP协议包中的一个值，它告诉网络路由器包在网络中的时间是否太长而应被丢弃。有很多原因使包在一定时间内不能被传递到目的地。
- TTL的最初设想是确定一个时间范围，超过此时间就把包丢弃。由于每个路由器都至少要把TTL域减一，TTL通常表示包在被丢弃前最多能经过的路由器个数。当记数到0时，路由器决定丢弃该包，并发送一个ICMP报文给最初的发送者。
- IPv6分组中的跳数限制域的功能IPv4分组中的TTL域的功能是一样的

## IPv6
- 对于一个完整的`IPv6`地址，需要128位，已经被分成了8个段，每个段4个字符。也就是说要完整的表示一个`IPv6`地址，需要些32个字母
- **表示方法**
  - **首选格式**
    - 首选格式的表示方法其实没有任何讲究，就是将`IPv6`中的128位，也就是共32个字符完完整整，一个不漏的全写出来。
  - **压缩表示**
    1. 将整个段4个字符全部都为0的使用双冒号`::`来表示。如果连续多个段全都为0，那么也可以同样将多个段都使用双冒号`::`来表示。如果是多个段，并不需要将双冒号写多次，只需要写一次即可。为了保证零压缩有一个不含混的解释，规定在任一地址中**只能使用一次**零压缩
    2. 表示`IPv6`地址时，允许将一个段中前部分的0省略不写，因为不影响结果。中间的0不能省略，只能省略最前面的0.
  - `IPv4`内嵌在`IPv6`中


# TCP协议
## TCP与UDP
- 用户数据报协议 UDP
  - UDP在传送数据之前不需要先建立连接，远程主机在收到UDP报文后，不需要给出任何确认。
  - 虽然UDP不提供可靠交付，但在某些情况下UDP却是一种最有效的工作方式
- 传输控制协议 TCP
  - TCP提供面向连接的服务。在传送数据之前必须先建立连接，数据传送结束后要释放连接。
  - TCP不提供广播或多播服务。由于TCP要提供可靠的，面向连接的传输服务（TCP的可靠体现在TCP在传递数据之前，会有三次握手来建立连接，而且在数据传递时，有确认、窗口、重传、流量控制、拥塞控制机制，在数据传完后，还会四次挥手断开连接用来节约系统资源），这不仅使协议数据单元的首部增大很多，还要占用许多处理机资源。
  - TCP 一般用于文件传输、发送和接收邮件、远程登录等场景。

## TCP报文段
![TCP报文段](https://segmentfault.com/img/remote/1460000039165596)
1. **源端口和目的端口**：各占2个字节，分别写入源端口和目的端口。IP地址+端口号就可以确定一个进程地址
2. **序号/序列号**（Sequense Number, SN）：在一个TCP连接中传送的字节流中的每一个字节都按顺序编号。该字段表示本报文段所发送的数据的第一个字节的序号。初始序号称为Init Sequense Number, ISN
3.  **确认号**ack：期望收到对方下一个报文段的第一个数据字节的序号。若确认号为N，则表明：到序号 N-1 为止的所有数据都已正确收到。

## 功能
- 完成对数据报的**确认**、**流量控制**和**网络拥塞**
- 自动检测数据报，并提供**错误重发**的功能
- 将多条路径传送的数据报按照原来的**顺序**进行排列，并对**重复**数据进行择取
- 控制**超时重发**，自动调整超时值
- 提供**自动恢复**丢失数据的功能
- *因此，除TCP功能以外需要程序员考虑的为发送数据的格式及应用层协议*

## 三次握手与四次挥手
- **标志位字段**: 占6比特
  - URG：**紧急比特**（urgent）,当`URG＝1`时，表明紧急指针字段有效,代表该封包为紧急封包。它告诉系统此报文段中有紧急数据，应尽快传送(相当于高优先级的数据)。
  - ACK：**确认比特**（Acknowledge）。只有当`ACK＝1`时确认号字段才有效,代表这个封包为确认封包。当`ACK＝0`时，确认号无效。
  - PSH：（Push function）若为1时，代表要求对方立即传送缓冲区内的其他对应封包，而无需等缓冲满了才送。
  - RST：**复位比特**(Reset) ,当`RST＝1`时，表明TCP连接中出现严重差错（如由于主机崩溃或其他原因），必须释放连接，然后再重新建立运输连接。
  - SYN：**同步比特**(Synchronous)，`SYN`置为1，就表示这是一个连接请求或连接接受报文,通常带有`SYN`标志的封包表示**主动**要连接到对方的意思。
  - FIN：**终止比特**(Final)，用来释放一个连接。当`FIN＝1`时，表明此报文段的发送端的数据已发送完毕，并要求释放运输连接。

# HTTP协议
## Cookie、localStorage、sessionStorage
特性 | Cookie | localStorage | sessionStorage
| :---: | :---:| :---: | :---: |
数据的生命期|一般由服务器生成，可设置失效时间。如在浏览器端生成Cookie，默认是关闭浏览器后失效|除非被清除，否则永久保存|仅在当前会话下有效，关闭页面或浏览器后清除
存放数据大小|4K左右|一般为5MB|一般为5MB
与服务器端通信|每次都会携带在HTTP头中，如果使用cookie保存过多数据会带来性能问题|仅在客户端中保存，不参与和服务器的通信|仅在客户端中保存，不参与和服务器的通信
易用性|需要程序员封装，原生接口不友好|原生接口可以接受，亦可再次封装来对Object和Array有更好的支持|原生接口可以接受，亦可再次封装来对Object和Array有更好的支持

- 都是保存在浏览器端，且同源的

## `get`与`post`
- `GET`请求的数据会附在`URL`之后（就是把数据放置在`HTTP`协议头中），以`?`分割`URL`和传输数据，参数之间以`&;`相连
- `GET`方式提交的数据最多只能是1024字节，理论上`POST`没有限制，可传较大量的数据，`IIS4`中最大为80KB，IIS5中为100KB
- 在`ASP`中，服务端获取`GET`请求参数用`Request.QueryString`，获取`POST`请求参数用`Request.Form`。
- 在`JSP`中，用`request.getParameter()`来获取，虽然`JSP`中也有`request.getQueryString()`方法，但使用起来比较麻烦
- 在`PHP`中，可以用`$_GET`和`$_POST`分别获取`GET`和`POST`中的数据，而`$_REQUEST`则可以获取`GET`和`POST`两种请求中的数据。值得注意的是，`JSP`中使用`request`和`PHP`中使用`$_REQUEST`都会有隐患
- POST的安全性要比GET的安全性高。
  - *注意：这里所说的安全性和上面`GET`提到的“安全”不是同个概念。上面“安全”的含义仅仅是不作数据修改，而这里安全的含义是真正的`Security`的含义*

